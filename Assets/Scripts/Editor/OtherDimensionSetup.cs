// Auto-generated by CursedPortal AI Spec v1.0
// Source: Module M18-M24 - OtherDimension Scene Setup

#if UNITY_EDITOR
using UnityEngine;
using UnityEditor;
using UnityEngine.Rendering;
using UnityEngine.Rendering.Universal;

/// <summary>
/// Editor tool to generate the OtherDimension finale scene.
/// Creates platform, spirit core, lighting, and UI elements.
/// </summary>
public class OtherDimensionSetup : Editor
{
    [MenuItem("CursedPortal/Create OtherDimension Scene")]
    public static void CreateOtherDimensionScene()
    {
        Debug.Log("[OtherDimensionSetup] Creating OtherDimension scene...");

        // Create root container
        GameObject root = new GameObject("OtherDimension");

        // Create PlayerRig spawn point
        CreatePlayerSpawn(root.transform);

        // Create floating platform
        CreatePlatform(root.transform);

        // Create spirit core (central glowing sphere)
        CreateSpiritCore(root.transform);

        // Create environment (mist, skybox elements)
        CreateEnvironment(root.transform);

        // Create UI elements
        CreateUIElements(root.transform);

        // Create lighting
        CreateLighting(root.transform);

        // Create post-processing volume
        CreatePostProcessing(root.transform);

        // Select the root object
        Selection.activeGameObject = root;

        Debug.Log("[OtherDimensionSetup] OtherDimension scene created successfully!");
        Debug.Log("[OtherDimensionSetup] Remember to save as 'OtherDimension.unity' in Assets/Scenes/");
    }

    private static void CreatePlayerSpawn(Transform parent)
    {
        GameObject playerSpawn = new GameObject("PlayerSpawn");
        playerSpawn.transform.SetParent(parent);
        playerSpawn.transform.position = new Vector3(0f, 1.8f, 0f);
        playerSpawn.AddComponent<PlayerSpawnMarker>();
        Debug.Log("[OtherDimensionSetup] Created PlayerSpawn");
    }

    private static void CreatePlatform(Transform parent)
    {
        GameObject platform = GameObject.CreatePrimitive(PrimitiveType.Cylinder);
        platform.name = "Platform";
        platform.transform.SetParent(parent);
        platform.transform.position = Vector3.zero;
        platform.transform.localScale = new Vector3(10f, 0.5f, 10f);

        Renderer renderer = platform.GetComponent<Renderer>();
        if (renderer != null)
        {
            Material mat = new Material(Shader.Find("Universal Render Pipeline/Lit"));
            mat.color = new Color(0.2f, 0.15f, 0.25f);
            mat.SetFloat("_Smoothness", 0.7f);
            renderer.material = mat;
        }

        // Edge glow ring
        GameObject edgeGlow = GameObject.CreatePrimitive(PrimitiveType.Torus);
        edgeGlow.name = "EdgeGlow";
        edgeGlow.transform.SetParent(platform.transform);
        edgeGlow.transform.localPosition = new Vector3(0f, 0.6f, 0f);
        edgeGlow.transform.localScale = new Vector3(1.05f, 0.1f, 1.05f);

        Renderer glowRenderer = edgeGlow.GetComponent<Renderer>();
        if (glowRenderer != null)
        {
            Material glowMat = new Material(Shader.Find("Universal Render Pipeline/Unlit"));
            glowMat.color = new Color(0.5f, 0.2f, 0.8f);
            glowMat.EnableKeyword("_EMISSION");
            glowMat.SetColor("_EmissionColor", new Color(0.5f, 0.2f, 0.8f) * 2f);
            glowRenderer.material = glowMat;
        }

        DestroyImmediate(edgeGlow.GetComponent<Collider>());
        Debug.Log("[OtherDimensionSetup] Created Platform");
    }

    private static void CreateSpiritCore(Transform parent)
    {
        GameObject spiritCore = GameObject.CreatePrimitive(PrimitiveType.Sphere);
        spiritCore.name = "SpiritCore";
        spiritCore.transform.SetParent(parent);
        spiritCore.transform.position = new Vector3(0f, 3f, 2f);
        spiritCore.transform.localScale = Vector3.one * 0.8f;

        DestroyImmediate(spiritCore.GetComponent<Collider>());

        Renderer renderer = spiritCore.GetComponent<Renderer>();
        if (renderer != null)
        {
            Material mat = new Material(Shader.Find("Universal Render Pipeline/Unlit"));
            mat.color = new Color(0.8f, 0.4f, 1f);
            mat.EnableKeyword("_EMISSION");
            mat.SetColor("_EmissionColor", new Color(0.8f, 0.4f, 1f) * 3f);
            renderer.material = mat;
        }

        spiritCore.AddComponent<DimensionalLight>();
        spiritCore.AddComponent<EpilogueNarrator>();

        GameObject coreLight = new GameObject("CoreLight");
        coreLight.transform.SetParent(spiritCore.transform);
        coreLight.transform.localPosition = Vector3.zero;
        Light light = coreLight.AddComponent<Light>();
        light.type = LightType.Point;
        light.color = new Color(0.8f, 0.4f, 1f);
        light.intensity = 3f;
        light.range = 15f;

        CreateOrbits(spiritCore.transform);
        Debug.Log("[OtherDimensionSetup] Created SpiritCore");
    }

    private static void CreateOrbits(Transform parent)
    {
        for (int i = 0; i < 3; i++)
        {
            GameObject wisp = GameObject.CreatePrimitive(PrimitiveType.Sphere);
            wisp.name = $"Wisp_{i}";
            wisp.transform.SetParent(parent);
            wisp.transform.localScale = Vector3.one * 0.15f;

            float angle = i * 120f * Mathf.Deg2Rad;
            wisp.transform.localPosition = new Vector3(Mathf.Cos(angle) * 1.5f, 0f, Mathf.Sin(angle) * 1.5f);

            DestroyImmediate(wisp.GetComponent<Collider>());

            Renderer renderer = wisp.GetComponent<Renderer>();
            if (renderer != null)
            {
                Color wispColor = i switch
                {
                    0 => new Color(1f, 0.3f, 0.3f),
                    1 => new Color(0.3f, 0.3f, 1f),
                    _ => new Color(0.3f, 1f, 0.5f)
                };

                Material mat = new Material(Shader.Find("Universal Render Pipeline/Unlit"));
                mat.color = wispColor;
                mat.EnableKeyword("_EMISSION");
                mat.SetColor("_EmissionColor", wispColor * 2f);
                renderer.material = mat;
            }

            wisp.AddComponent<OrbitalMotion>();
        }
    }

    private static void CreateEnvironment(Transform parent)
    {
        GameObject environment = new GameObject("Environment");
        environment.transform.SetParent(parent);

        GameObject mistObj = new GameObject("MistParticles");
        mistObj.transform.SetParent(environment.transform);
        mistObj.transform.position = new Vector3(0f, 0.5f, 0f);

        ParticleSystem mist = mistObj.AddComponent<ParticleSystem>();
        var main = mist.main;
        main.startLifetime = 8f;
        main.startSpeed = 0.2f;
        main.startSize = 3f;
        main.startColor = new Color(0.3f, 0.2f, 0.4f, 0.3f);
        main.maxParticles = 100;
        main.simulationSpace = ParticleSystemSimulationSpace.World;

        var emission = mist.emission;
        emission.rateOverTime = 10f;

        var shape = mist.shape;
        shape.shapeType = ParticleSystemShapeType.Circle;
        shape.radius = 8f;

        GameObject voidObj = new GameObject("VoidParticles");
        voidObj.transform.SetParent(environment.transform);
        voidObj.transform.position = new Vector3(0f, 10f, 0f);

        ParticleSystem voidParticles = voidObj.AddComponent<ParticleSystem>();
        var voidMain = voidParticles.main;
        voidMain.startLifetime = 10f;
        voidMain.startSpeed = 0.5f;
        voidMain.startSize = 0.1f;
        voidMain.startColor = new Color(0.8f, 0.5f, 1f, 0.5f);
        voidMain.maxParticles = 200;
        voidMain.gravityModifier = 0.1f;

        var voidEmission = voidParticles.emission;
        voidEmission.rateOverTime = 20f;

        var voidShape = voidParticles.shape;
        voidShape.shapeType = ParticleSystemShapeType.Box;
        voidShape.scale = new Vector3(15f, 1f, 15f);

        Debug.Log("[OtherDimensionSetup] Created Environment");
    }

    private static void CreateUIElements(Transform parent)
    {
        GameObject canvasObj = new GameObject("UIEpilogueCanvas");
        canvasObj.transform.SetParent(parent);

        Canvas canvas = canvasObj.AddComponent<Canvas>();
        canvas.renderMode = RenderMode.ScreenSpaceOverlay;
        canvas.sortingOrder = 100;

        canvasObj.AddComponent<UnityEngine.UI.CanvasScaler>();
        canvasObj.AddComponent<UnityEngine.UI.GraphicRaycaster>();
        canvasObj.AddComponent<UIEpilogue>();

        GameObject panel = new GameObject("TextPanel");
        panel.transform.SetParent(canvasObj.transform);

        UnityEngine.UI.Image panelImage = panel.AddComponent<UnityEngine.UI.Image>();
        panelImage.color = new Color(0f, 0f, 0f, 0.7f);

        RectTransform panelRect = panel.GetComponent<RectTransform>();
        panelRect.anchorMin = new Vector2(0.1f, 0.1f);
        panelRect.anchorMax = new Vector2(0.9f, 0.4f);
        panelRect.offsetMin = Vector2.zero;
        panelRect.offsetMax = Vector2.zero;

        GameObject textObj = new GameObject("EpilogueText");
        textObj.transform.SetParent(panel.transform);

        UnityEngine.UI.Text text = textObj.AddComponent<UnityEngine.UI.Text>();
        text.text = "";
        text.fontSize = 24;
        text.color = new Color(0.9f, 0.8f, 1f);
        text.alignment = TextAnchor.MiddleCenter;
        text.font = Resources.GetBuiltinResource<Font>("LegacyRuntime.ttf");

        RectTransform textRect = textObj.GetComponent<RectTransform>();
        textRect.anchorMin = Vector2.zero;
        textRect.anchorMax = Vector2.one;
        textRect.offsetMin = new Vector2(20f, 20f);
        textRect.offsetMax = new Vector2(-20f, -20f);

        GameObject promptObj = new GameObject("PromptText");
        promptObj.transform.SetParent(canvasObj.transform);

        UnityEngine.UI.Text prompt = promptObj.AddComponent<UnityEngine.UI.Text>();
        prompt.text = "[E] to Awaken";
        prompt.fontSize = 18;
        prompt.color = new Color(0.7f, 0.7f, 0.9f, 0f);
        prompt.alignment = TextAnchor.MiddleCenter;
        prompt.font = Resources.GetBuiltinResource<Font>("LegacyRuntime.ttf");

        RectTransform promptRect = promptObj.GetComponent<RectTransform>();
        promptRect.anchorMin = new Vector2(0.3f, 0.05f);
        promptRect.anchorMax = new Vector2(0.7f, 0.1f);
        promptRect.offsetMin = Vector2.zero;
        promptRect.offsetMax = Vector2.zero;

        Debug.Log("[OtherDimensionSetup] Created UI Elements");
    }

    private static void CreateLighting(Transform parent)
    {
        GameObject lighting = new GameObject("Lighting");
        lighting.transform.SetParent(parent);

        GameObject dirLightObj = new GameObject("DirectionalLight");
        dirLightObj.transform.SetParent(lighting.transform);
        dirLightObj.transform.rotation = Quaternion.Euler(50f, -30f, 0f);

        Light dirLight = dirLightObj.AddComponent<Light>();
        dirLight.type = LightType.Directional;
        dirLight.color = new Color(0.3f, 0.2f, 0.4f);
        dirLight.intensity = 0.3f;

        for (int i = 0; i < 4; i++)
        {
            float angle = i * 90f * Mathf.Deg2Rad;
            Vector3 pos = new Vector3(Mathf.Cos(angle) * 12f, 2f, Mathf.Sin(angle) * 12f);

            GameObject rimLightObj = new GameObject($"RimLight_{i}");
            rimLightObj.transform.SetParent(lighting.transform);
            rimLightObj.transform.position = pos;

            Light rimLight = rimLightObj.AddComponent<Light>();
            rimLight.type = LightType.Point;
            rimLight.color = new Color(0.4f, 0.2f, 0.6f);
            rimLight.intensity = 1f;
            rimLight.range = 10f;
        }

        RenderSettings.ambientMode = UnityEngine.Rendering.AmbientMode.Flat;
        RenderSettings.ambientLight = new Color(0.1f, 0.05f, 0.15f);
        RenderSettings.fog = true;
        RenderSettings.fogMode = FogMode.Exponential;
        RenderSettings.fogColor = new Color(0.05f, 0.02f, 0.1f);
        RenderSettings.fogDensity = 0.05f;

        Debug.Log("[OtherDimensionSetup] Created Lighting");
    }

    private static void CreatePostProcessing(Transform parent)
    {
        GameObject ppVolume = new GameObject("PostProcessVolume");
        ppVolume.transform.SetParent(parent);

        Volume volume = ppVolume.AddComponent<Volume>();
        volume.isGlobal = true;
        volume.priority = 1f;

        VolumeProfile profile = ScriptableObject.CreateInstance<VolumeProfile>();

        Vignette vignette = profile.Add<Vignette>();
        vignette.intensity.Override(0.5f);
        vignette.color.Override(new Color(0.2f, 0f, 0.3f));

        ColorAdjustments colorAdj = profile.Add<ColorAdjustments>();
        colorAdj.saturation.Override(-30f);
        colorAdj.contrast.Override(20f);
        colorAdj.colorFilter.Override(new Color(0.8f, 0.7f, 1f));

        Bloom bloom = profile.Add<Bloom>();
        bloom.threshold.Override(0.8f);
        bloom.intensity.Override(2f);
        bloom.tint.Override(new Color(0.8f, 0.5f, 1f));

        volume.profile = profile;

        Debug.Log("[OtherDimensionSetup] Created Post-Processing Volume");
    }
}
#endif
